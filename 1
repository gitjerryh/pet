[Unit]
Description=树莓派摄像头流服务
After=network.target
Wants=network-online.target

[Service]
Type=simple
User=Goodman
WorkingDirectory=/home/Goodman
ExecStart=/usr/bin/python3 /home/Goodman/camera_server.py
Restart=always
RestartSec=10
# 增加终止超时，确保程序有足够时间清理资源
TimeoutStopSec=20
# 系统日志改为直接写入文件
StandardOutput=append:/home/Goodman/camera_service.log
StandardError=append:/home/Goodman/camera_service.log
# 设置环境变量
Environment=PYTHONUNBUFFERED=1

# 增加限制以保护系统
CPUQuota=80%
MemoryLimit=300M

[Install]
WantedBy=multi-user.target 
